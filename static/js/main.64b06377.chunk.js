(this["webpackJsonpcollections-web"]=this["webpackJsonpcollections-web"]||[]).push([[0],{102:function(e,t,a){e.exports=a(151)},151:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(34),c=a.n(r),l=a(2),s=a(37),i=a(5),m=a(6),u=a(9),d=a(8),p=a(47),h=a.n(p),f=a(55),g=function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/book/").concat(e),{method:"GET"}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},E=function(e,t){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/book/").concat(e),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},b=function(e,t,a){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/book/like"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,bookId:a})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},v=function(e,t,a){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/book/unlike"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,bookId:a})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},k=function(e,t,a,n){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/book/comment"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,bookId:a,comment:n})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},N=function(e,t,a,n){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/book/uncomment"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,bookId:a,comment:n})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},y=a(22),C=a.n(y),w=a(14),S=a(12),j=a(11),O=a(46),x=function(e,t,a){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collection/new/").concat(e),{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)},body:a}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},T=function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collection/").concat(e),{method:"GET"}).then((function(e){return console.log(e),e.json()})).catch((function(e){return console.log(e)}))},B=function(e,t){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collections/by/").concat(e),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},P=function(e,t){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collection/delete/").concat(e),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},D=function(e,t,a){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collection/like"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,collectionId:a})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},A=function(e,t,a){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collection/unlike"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,collectionId:a})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},_=function(e,t,a,n){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collection/comment"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,collectionId:a,comment:n})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},I=function(e,t,a,n){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collection/uncomment"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,collectionId:a,comment:n})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},F=function(e,t,a,n){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collection/book"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,collectionId:a,bookId:n})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},z=function(e,t,a,n){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collection/unbook"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,collectionId:a,bookId:n})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},U=a(156),L=a(157),R=a(158),M=a(94),H=function(e,t){"undefined"!==typeof window&&(localStorage.setItem("jwt",JSON.stringify(e)),t())},J=function(e){return"undefined"!==typeof window&&localStorage.removeItem("jwt"),e(),fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/signout"),{method:"GET"}).then((function(e){return console.log("signout",e),e.json()})).catch((function(e){return console.log(e)}))},G=function(){return"undefined"!=typeof window&&(!!localStorage.getItem("jwt")&&JSON.parse(localStorage.getItem("jwt")))},V=function(e){return console.log("email: ",e),fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/forgot-password/"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e})}).then((function(e){return console.log("forgot password response: ",e),e.json()})).catch((function(e){return console.log(e)}))},q=a(16),W=a.n(q),K=(n.Component,function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).componentDidMount=function(){e.setState({show:e.props.show,book:e.props.book}),e.getCollections()},e.handleClose=function(t){console.log("hh"),e.setState({show:!1},(function(){e.props.onClose&&e.props.onClose(t),e.onShowAlert()}))},e.onClose=function(t){e.props.show=!1},e.handleCloseAlert=function(t){e.setState({visible:!1}),e.props.onClose&&e.props.onClose(t)},e.saveChanges=function(){e.handleClose()},e.handleOpen=function(){e.getCollections()},e.handleChange=function(t){if(t.persist(),t.target.checked)e.setState((function(a){return a.selectedCollections.push(t.target.value),console.log(e.state.selectedCollections)}));else{var a=Object(O.a)(e.state.selectedCollections),n=e.state.selectedCollections.indexOf(t.target.value);if(-1!==n){a=a.splice(1,n);e.setState((function(t){return t.selectedCollections.splice(n,1),console.log(e.state.selectedCollections)}))}}},e.submitForm=function(t){t.preventDefault();var a=t.target,n=new FormData(a);e.collectionData=new FormData;var o=e.state.existingCollections.filter((function(t){return!e.state.selectedCollections.includes(t)})),r=e.state.selectedCollections.filter((function(t){return!e.state.existingCollections.includes(t)}));console.log(r.length),e.setState({totalCollectionsRemoved:o.length,totalCollectionsAdded:r.length}),r.forEach((function(t){F(G().user._id,G().token,t,e.props.book._id).then((function(e){e.error?console.log(e.error):console.log(e)}))})),o.forEach((function(t){z(G().user._id,G().token,t,e.props.book._id).then((function(e){e.error?console.log(e.error):console.log(e)}))})),void 0!=n.get("collectionName")?(e.collectionData.set("name",n.get("collectionName")),e.collectionData.set("privacy",n.get("collectionPrivacy")),x(G().user._id,G().token,e.collectionData).then((function(t){t.error?console.log(t.error):F(G().user._id,G().token,t._id,e.props.book._id).then((function(t){t.error?console.log(t.error):(console.log(t),e.handleClose())}))}))):e.handleClose()},e.getCollections=function(){e.setState({loadingModal:!0});var t=G().user._id,a=G().token,n=[],o=e.props.book._id;console.log(e.props.book),B(t,a).then((function(t){if(t.error)console.log(t.error);else{console.log(t),t.forEach((function(e){e.books.forEach((function(t){t._id===o&&n.push(e._id)}))}));var a=n.slice();console.log(n),e.setState({collections:t,selectedCollections:n.slice(),loadingModal:!1}),e.setState({existingCollections:a.slice()})}}))},e.onShowAlert=function(){e.setState({visible:!0},(function(){window.setTimeout((function(){e.setState({visible:!1})}),2e3)}))},e.state=Object(j.a)({collections:[],show:!1,book:{},visible:!1,totalCollectionsRemoved:0},"totalCollectionsRemoved",0),e}return Object(m.a)(a,[{key:"componentDidUpdate",value:function(){this.state.show!==this.props.show&&this.setState({show:this.props.show})}},{key:"render",value:function(){var e=this;if(!this.props.show)return null;this.state.book.createdBy&&"/user/".concat(this.state.book.createdBy._id),this.state.book.createdBy&&this.state.book.createdBy.name;var t=this.state,a=(t.like,t.likes,t.show),n=t.collections,r=t.showForm,c=(t.comments,t.loading,t.loadingModal),l=(t.book,t.visible),s=t.selectedCollections;t.totalCollectionsAdded,t.totalCollectionsRemoved;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"row"},o.a.createElement(U.a,{color:"info",show:l},"I am an alert and I will disappear in 2sec.!")),o.a.createElement(L.a,{show:a,className:"modal-m",onHide:this.handleClose},o.a.createElement(L.a.Header,{closeButton:!0},o.a.createElement(L.a.Title,null,"Select collections:")),o.a.createElement(R.a,{onSubmit:this.submitForm},o.a.createElement(L.a.Body,null,c&&0==n.length?o.a.createElement(L.a.Title,null,"Loading..."):n.map((function(t,a){return o.a.createElement("div",{key:a},o.a.createElement(R.a.Group,null,o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-10"},o.a.createElement(R.a.Check,{className:"ml-4",onChange:e.handleChange,value:t._id,type:"checkbox",name:t._id,label:t.name,defaultChecked:s.includes(t._id)})),o.a.createElement("div",{className:"col-2"},o.a.createElement(w.a,{icon:"private"==t.privacy?S.d:S.e})))))})),o.a.createElement("hr",{className:"dashed"}),r?null:o.a.createElement(M.a,{variant:"secondary",onClick:this.showCreate},o.a.createElement(w.a,{className:"mr-2",icon:S.h}),"Create Collection"),r?o.a.createElement(o.a.Fragment,null,o.a.createElement(R.a.Group,{controlId:"collectionName"},o.a.createElement(R.a.Label,{className:""},"Name"),o.a.createElement(R.a.Control,{type:"text",name:"collectionName",placeholder:"Collection name"})),o.a.createElement(R.a.Group,{controlId:"collectionPrivacy"},o.a.createElement(R.a.Label,null,"Privacy"),o.a.createElement(R.a.Control,{as:"select",name:"collectionPrivacy"},o.a.createElement("option",{value:"private"},"Private"),o.a.createElement("option",{value:"public"},"Public"),o.a.createElement("option",{value:"followPrivate"},"Public to followers")))):null),o.a.createElement(L.a.Footer,null,o.a.createElement(M.a,{variant:"secondary",onClick:this.handleClose},"Close"),o.a.createElement(M.a,{variant:"primary",type:"submit"},"Save Changes")))))}}]),a}(n.Component)),Y=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).loadBooks=function(t){(function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/books/?page=").concat(e),{method:"GET"}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))})(t).then((function(t){t?e.setState({books:t}):e.setState({books:[]})}))},e.handleOpen=function(){e.setState({show:!0}),console.log("ASDFASS")},e.showModal=function(t){console.log(t),e.setState({show:!e.state.show})},e.loadMore=function(t){e.setState({page:e.state.page+t}),e.loadBooks(e.state.page+t)},e.loadLess=function(t){e.setState({page:e.state.page-t}),e.loadBooks(e.state.page-t)},e.renderBooks=function(t){var a=e.state.show;return o.a.createElement("div",{className:"row"},t.map((function(t,n){var r=t.createdBy?"/user/".concat(t.createdBy._id):"",c=t.createdBy?t.createdBy.name:" Unknown";return o.a.createElement("div",{className:"card col-md-3 mr-3 mt-3",key:n},o.a.createElement("div",{className:"card-body"},G().user?o.a.createElement("div",{className:"row justify-content-end"},o.a.createElement("div",{className:"col-1"},o.a.createElement(K,{show:a,onClose:e.showModal,book:t._id}),o.a.createElement("button",{className:"btn",style:{padding:0},onClick:e.handleOpen,variant:"primary"},o.a.createElement(w.a,{icon:S.c})))):null,o.a.createElement("img",{src:t.photo,alt:t.title,onError:function(e){return e.target.src="".concat(C.a)},className:"img-thunbnail mb-3",style:{height:"150px",width:"auto"}}),o.a.createElement("h5",{className:"card-title"},t.title),o.a.createElement("p",{className:"card-text"},t.editorial.substring(0,100)),o.a.createElement("br",null),o.a.createElement("p",{className:"font-italic"},"Posted by"," ",o.a.createElement(l.c,{to:"".concat(r)},c," "),"on ",new Date(t.created).toDateString()),o.a.createElement(l.c,{to:"/book/".concat(t._id),className:"btn btn-raised btn-primary btn-sm"},"Read more")))})))},e.state={books:[],page:1,show:!1,visible:!1},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.loadBooks(this.state.page)}},{key:"render",value:function(){var e=this,t=this.state,a=t.books,n=t.page;return o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},a.length?"Recent Books":"No more books!"),this.renderBooks(a),n>1?o.a.createElement("button",{className:"btn btn-raised btn-warning mr-5 mt-5 mb-5",onClick:function(){return e.loadLess(1)}},"Previous (",this.state.page-1,")"):"",a.length?o.a.createElement("button",{className:"btn btn-raised btn-success mt-5 mb-5",onClick:function(){return e.loadMore(1)}},"Next (",n+1,")"):"")}}]),a}(n.Component),$=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={search:"",go:!1},e.clickSearch=function(t){e.setState({go:!0})},e.handleChange=function(t){return function(a){e.setState({error:""});var n=a.target.value;e.setState(Object(j.a)({},t,n))}},e}return Object(m.a)(a,[{key:"render",value:function(){if(this.state.redirectToSignin)return o.a.createElement(s.a,{to:"/signin"});return o.a.createElement("div",{style:{color:"#ff9900",backgroundImage:"url(https://images.unsplash.com/photo-1457369804613-52c61a468e7d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1050&q=80)",opacity:.5}},o.a.createElement("div",{className:"row justify-content-center"},o.a.createElement("div",{className:"col-12 col-md-10 col-lg-8 mt-5 mb-5"},o.a.createElement("img",{src:""}),o.a.createElement("form",{className:"card card-sm"},o.a.createElement("div",{className:"card-body row no-gutters align-items-center"},o.a.createElement("div",{className:"col"},o.a.createElement("input",{className:"form-control form-control-lg form-control-borderless",onChange:this.handleChange("search"),type:"search",placeholder:"     Search for books, collections or users"})),o.a.createElement("div",{className:"col-auto"},o.a.createElement("button",{className:"btn btn-lg ml-2",onClick:this.clickSearch},o.a.createElement(w.a,{icon:S.j,size:"2x"}))))))),this.state.go&&o.a.createElement(s.a,{to:{pathname:"/finder",state:{search:this.state.search}}}))}}]),a}(n.Component),X=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).loadCollections=function(t){(function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collections/?page=").concat(e),{method:"GET"}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))})(t).then((function(t){t?e.setState({collections:t}):e.setState({collections:[]})}))},e.loadMore=function(t){e.setState({page:e.state.page+t}),e.loadCollections(e.state.page+t)},e.loadLess=function(t){e.setState({page:e.state.page-t}),e.loadCollections(e.state.page-t)},e.renderCollections=function(e){return o.a.createElement("div",{className:"row"},e.map((function(e,t){var a=e.createdBy?"/user/".concat(e.createdBy._id):"",n=e.createdBy?e.createdBy.name:" Unknown";return o.a.createElement("div",{className:"card mr-3 mt-3",key:t},o.a.createElement("div",{className:"card-body"},o.a.createElement("img",{src:e.photo,alt:e.name,onError:function(e){return e.target.src="".concat(C.a)},className:"img-thunbnail mb-3",style:{height:"150px",width:"auto"}}),o.a.createElement("h5",{className:"card-name"},e.name),o.a.createElement("p",{className:"card-text"},e.about?e.about.substring(0,100):null),o.a.createElement("br",null),o.a.createElement("p",{className:"font-italic"},"Created by"," ",o.a.createElement(l.c,{to:"".concat(a)},n," "),"on ",new Date(e.created).toDateString()),o.a.createElement(l.c,{to:"/collection/".concat(e._id),className:"btn btn-raised btn-primary btn-sm"},"Read more")))})))},e.state={collections:[],page:1},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.loadCollections(this.state.page)}},{key:"render",value:function(){var e=this,t=this.state,a=t.collections,n=t.page;return o.a.createElement("div",{className:"container card-group"},o.a.createElement("h2",{className:"mt-5 mb-5"},a.length?"Recent Collections":"No more collections!"),this.renderCollections(a),n>1?o.a.createElement("button",{className:"btn btn-raised btn-warning mr-5 mt-5 mb-5",onClick:function(){return e.loadLess(1)}},"Previous (",this.state.page-1,")"):"",a.length?o.a.createElement("button",{className:"btn btn-raised btn-success mt-5 mb-5",onClick:function(){return e.loadMore(1)}},"Next (",n+1,")"):"")}}]),a}(n.Component),Q=function(){return o.a.createElement("div",null,o.a.createElement($,null),o.a.createElement(X,null),o.a.createElement(Y,null))},Z=a(159),ee=function(e,t){return e.location.pathname===t?{color:"#ff9900"}:{color:"#ffffff"}},te=(Object(s.g)((function(e){var t=e.history;return o.a.createElement("div",{className:"navbar-collapse"},o.a.createElement("ul",{className:"nav nav-tabs bg-primary"},o.a.createElement("li",{className:"nav-item"},o.a.createElement(l.c,{className:"nav-link",style:ee(t,"/"),to:"/"},"Home")),o.a.createElement("li",{className:"nav-item"},o.a.createElement(l.c,{className:"/users"===t.location.pathname?"active nav-link":"not-active nav-link",to:"/users"},"Users")),o.a.createElement("li",{className:"nav-item"},o.a.createElement(Z.a,{title:"Create",id:"collasible-nav-dropdown"},o.a.createElement(Z.a.Item,{href:"/book/create"},"Book"),o.a.createElement(Z.a.Item,{href:"/collection/create"},"Collection"))),!G()&&o.a.createElement(o.a.Fragment,null,o.a.createElement("li",{className:"nav-item"},o.a.createElement(l.c,{className:"nav-link",style:ee(t,"/signin"),to:"/signin"},"Sign In")),o.a.createElement("li",{className:"nav-item"},o.a.createElement(l.c,{className:"nav-link",style:ee(t,"/signup"),to:"/signup"},"Sign Up"))),G()&&"admin"===G().user.role&&o.a.createElement("li",{className:"nav-item"},o.a.createElement(l.c,{to:"/admin",style:ee(t,"/admin"),className:"nav-link"},"Admin")),G()&&o.a.createElement(o.a.Fragment,null,o.a.createElement("li",{className:"nav-item"},o.a.createElement(l.c,{to:"/finder",style:ee(t,"/finder"),className:"nav-link"},"Search")),o.a.createElement("li",{className:"nav-item"},o.a.createElement(l.c,{to:"/user/".concat(G().user._id),style:ee(t,"/user/".concat(G().user._id)),className:"nav-link"},"".concat(G().user.name,"'s profile"))),o.a.createElement("li",{className:"nav-item"},o.a.createElement("span",{className:"nav-link",style:{cursor:"pointer",color:"#fff"},onClick:function(){return J((function(){return t.push("/")}))}},"Sign Out")))))})),a(160)),ae=a(161),ne=function(e,t){return"/create"!==t?e.location.pathname===t?{color:"#ff9900"}:{color:"#ffffff"}:"/book/create"===e.location.pathname||"/collection/create"===e.location.pathname?{color:"#ff9900"}:void 0},oe=Object(s.g)((function(e){var t=e.history;return o.a.createElement(te.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark"},o.a.createElement(te.a.Brand,{href:"/",style:ne(t,"/")},o.a.createElement(w.a,{className:"mr-2",size:"2x",icon:S.b})),o.a.createElement(te.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),o.a.createElement(te.a.Collapse,{id:"responsive-navbar-nav"},o.a.createElement(ae.a,{className:"mr-auto"},o.a.createElement(ae.a.Link,{href:"/users",style:ne(t,"/users"),className:"/users"===t.location.pathname?"active nav-link":"not-active nav-link"},"Users"),o.a.createElement(Z.a,{title:"Add",id:"collasible-nav-dropdown",style:ne(t,"/create")},o.a.createElement(Z.a.Item,{href:"/book/create"},o.a.createElement(w.a,{className:"mr-2",icon:S.a}),"Book"),o.a.createElement(Z.a.Item,{href:"/collection/create"},o.a.createElement(w.a,{className:"mr-2",icon:S.l}),"Collection"))),o.a.createElement(ae.a,null,!G()&&o.a.createElement(ae.a.Link,{href:"/signin"},"Sign in"),!G()&&o.a.createElement(ae.a.Link,{href:"/signup"},"Register"),G()&&o.a.createElement(Z.a,{className:"mr-5",title:G().user.name,id:"collasible-nav-dropdown",style:ne(t,"/create")},o.a.createElement(Z.a.Item,{className:"",href:"/user/".concat(G().user._id)},o.a.createElement(w.a,{className:"mr-2",icon:S.o})," Profile"),o.a.createElement(Z.a.Item,{className:"",onClick:function(){return J((function(){return t.push("/")}))}},o.a.createElement(w.a,{className:"mr-2",icon:S.k})," Sign Out")))))})),re=a(96),ce=a.n(re),le=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).responseGoogle=function(t){(function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/social-login/"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return console.log("signin response: ",e),e.json()})).catch((function(e){return console.log(e)}))})({tokenId:t.tokenId}).then((function(t){t.error?console.log("Error Login. Please try again.."):H(t,(function(){console.log("social login response from api",t),e.setState({redirectToReferrer:!0})}))}))},e.state={redirectToReferrer:!1},e}return Object(m.a)(a,[{key:"render",value:function(){return this.state.redirectToReferrer?o.a.createElement(s.a,{to:"/"}):o.a.createElement(ce.a,{clientId:"399479435902-9i03bv7ergt57l7pd6k598rfb9662174.apps.googleusercontent.com",buttonText:"Login",onSuccess:this.responseGoogle,onFailure:this.responseGoogle,cookiePolicy:"single_host_origin"})}}]),a}(n.Component),se=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).handleChange=function(t){return function(a){e.setState({error:""}),e.setState(Object(j.a)({},t,a.target.value))}},e.recaptchaHandler=function(t){e.setState({error:""});var a,n=t.target.value.toLowerCase();return"sunday"===n?a=0:"monday"===n?a=1:"tuesday"===n?a=2:"wednesday"===n?a=3:"thursday"===n?a=4:"friday"===n?a=5:"saturday"===n&&(a=6),a===(new Date).getDay()?(e.setState({recaptcha:!0}),!0):(e.setState({recaptcha:!1}),!1)},e.clickSubmit=function(t){t.preventDefault();var a=e.state,n={name:a.name,email:a.email,password:a.password};console.log(n),e.state.recaptcha?function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))}(n).then((function(t){console.log(t),t.error?e.setState({error:t.error}):e.setState({error:"",name:"",email:"",password:"",open:!0})})):e.setState({error:"What day is today? Please write a correct answer!"})},e.signupForm=function(t,a,n,r){return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Name"),o.a.createElement("input",{onChange:e.handleChange("name"),type:"text",className:"form-control",value:t})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Email"),o.a.createElement("input",{onChange:e.handleChange("email"),type:"email",className:"form-control",value:a})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Password"),o.a.createElement("input",{onChange:e.handleChange("password"),type:"password",className:"form-control",value:n})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},r?"Thanks. You got it!":"What day is today?"),o.a.createElement("input",{onChange:e.recaptchaHandler,type:"text",className:"form-control"})),o.a.createElement("button",{onClick:e.clickSubmit,className:"btn btn-raised btn-primary"},"Submit"))},e.state={name:"",email:"",password:"",error:"",open:!1,recaptcha:!1},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.state,t=e.name,a=e.email,n=e.password,r=e.error,c=e.open,s=e.recaptcha;return o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"Signup"),o.a.createElement("hr",null),o.a.createElement(le,null),o.a.createElement("hr",null),o.a.createElement("br",null),o.a.createElement("div",{className:"alert alert-danger",style:{display:r?"":"none"}},r),o.a.createElement("div",{className:"alert alert-info",style:{display:c?"":"none"}},"New account is successfully created. Please"," ",o.a.createElement(l.c,{to:"/signin"},"Sign In"),"."),this.signupForm(t,a,n,s))}}]),a}(n.Component),ie=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).handleChange=function(t){return function(a){e.setState({error:""}),e.setState(Object(j.a)({},t,a.target.value))}},e.recaptchaHandler=function(t){e.setState({error:""});var a,n=t.target.value.toLowerCase();return"sunday"===n?a=0:"monday"===n?a=1:"tuesday"===n?a=2:"wednesday"===n?a=3:"thursday"===n?a=4:"friday"===n?a=5:"saturday"===n&&(a=6),a===(new Date).getDay()?(e.setState({recaptcha:!0}),!0):(e.setState({recaptcha:!1}),!1)},e.clickSubmit=function(t){t.preventDefault(),e.setState({loading:!0});var a=e.state,n={email:a.email,password:a.password};e.state.recaptcha?function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))}(n).then((function(t){t.error?e.setState({error:t.error,loading:!1}):H(t,(function(){e.setState({redirectToReferer:!0})}))})):e.setState({loading:!1,error:"What day is today? Please write a correct answer!"})},e.signinForm=function(t,a,n){return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Email"),o.a.createElement("input",{onChange:e.handleChange("email"),type:"email",className:"form-control",value:t})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Password"),o.a.createElement("input",{onChange:e.handleChange("password"),type:"password",className:"form-control",value:a})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},n?"Thanks. You got it!":"What day is today?"),o.a.createElement("input",{onChange:e.recaptchaHandler,type:"text",className:"form-control"})),o.a.createElement("button",{onClick:e.clickSubmit,className:"btn btn-raised btn-primary"},"Submit"))},e.state={email:"",password:"",error:"",redirectToReferer:!1,loading:!1,recaptcha:!1},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.password,n=e.error,r=e.redirectToReferer,c=e.loading,i=e.recaptcha;return r?o.a.createElement(s.a,{to:"/"}):o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"SignIn"),o.a.createElement("hr",null),o.a.createElement(le,null),o.a.createElement("hr",null),o.a.createElement("br",null),o.a.createElement("div",{className:"alert alert-danger",style:{display:n?"":"none"}},n),c?o.a.createElement("div",{className:"jumbotron text-center"},o.a.createElement("h2",null,"Loading...")):"",this.signinForm(t,a,i),o.a.createElement("p",null,o.a.createElement(l.c,{to:"/forgot-password",className:"btn btn-raised btn-danger"}," ","Forgot Password")))}}]),a}(n.Component),me=function(e,t){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/user/").concat(e),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},ue=function(e,t){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/user/").concat(e),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},de=function(e,t,a){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/user/follow"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,followId:a})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},pe=function(e,t,a){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/user/unfollow"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,unfollowId:a})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},he=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={redirect:!1},e.deleteAccount=function(){var t=G().token,a=e.props.userId;ue(a,t).then((function(t){t.error?console.log(t.error):(J((function(){return console.log("User is deleted")})),e.setState({redirect:!0}))}))},e.deleteConfirmed=function(){window.confirm("Are you sure you want to delete your account?")&&e.deleteAccount()},e}return Object(m.a)(a,[{key:"render",value:function(){return this.state.redirect?o.a.createElement(s.a,{to:"/"}):o.a.createElement("button",{onClick:this.deleteConfirmed,className:"btn btn-raised btn-danger"},"Delete Profile")}}]),a}(n.Component),fe=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).followClick=function(){e.props.onButtonClick(de)},e.unfollowClick=function(){e.props.onButtonClick(pe)},e}return Object(m.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"d-inline-block"},this.props.following?o.a.createElement("button",{onClick:this.unfollowClick,className:"btn btn-warning btn-raised"},"UnFollow"):o.a.createElement("button",{onClick:this.followClick,className:"btn btn-success btn-raised mr-5"},"Follow"))}}]),a}(n.Component),ge=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props,t=e.following,a=e.followers,n=(e.books,e.collections),r=e.followedCollections;return o.a.createElement("div",null,o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-3"},o.a.createElement("h3",{className:"text-primary"},a.length," Followers"),o.a.createElement("hr",null),a.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement("div",null,o.a.createElement(l.c,{to:"/user/".concat(e._id)},o.a.createElement("img",{style:{borderRadius:"50%",border:"1px solid black"},className:"float-left mr-2",height:"30px",width:"30px",onError:function(e){return e.target.src="".concat(W.a)},src:"".concat("https://ameliacollections-api.herokuapp.com/api","/user/photo/").concat(e._id),alt:e.name}),o.a.createElement("div",null,o.a.createElement("p",{className:"lead"},e.name)))))}))),o.a.createElement("div",{className:"col-md-3"},o.a.createElement("h3",{className:"text-primary"},t.length," Following"),o.a.createElement("hr",null),t.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement("div",null,o.a.createElement(l.c,{to:"/user/".concat(e._id)},o.a.createElement("img",{style:{borderRadius:"50%",border:"1px solid black"},className:"float-left mr-2",height:"30px",width:"30px",onError:function(e){return e.target.src="".concat(W.a)},src:"".concat("https://ameliacollections-api.herokuapp.com/api","/user/photo/").concat(e._id),alt:e.name}),o.a.createElement("div",null,o.a.createElement("p",{className:"lead"},e.name)))))}))),o.a.createElement("div",{className:"col-md-3"},o.a.createElement("h3",{className:"text-primary"},n.length," Collections"),o.a.createElement("hr",null),n.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement("div",null,o.a.createElement(l.c,{to:"/collection/".concat(e._id)},o.a.createElement("div",null,o.a.createElement("p",{className:"lead"},e.name)))))}))),o.a.createElement("div",{className:"col-md-3"},o.a.createElement("h3",{className:"text-primary"},n.length," Followed Collections"),o.a.createElement("hr",null),r.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement("div",null,o.a.createElement(l.c,{to:"/collection/".concat(e._id)},o.a.createElement("div",null,o.a.createElement("p",{className:"lead"},e.name)))))})))))}}]),a}(n.Component),Ee=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).checkFollow=function(e){var t=G();return e.followers.find((function(e){return e._id===t.user._id}))},e.clickFollowButton=function(t){t(G().user._id,G().token,e.state.user._id).then((function(t){t.error?e.setState({error:t.error}):e.setState({user:t,following:!e.state.following})}))},e.init=function(t){var a=G().token;me(t,a).then((function(t){if(t.error)e.setState({redirectToSignin:!0});else{var a=e.checkFollow(t);e.setState({user:t,following:a}),e.loadBooks(t._id),e.loadCollections(t._id)}}))},e.loadBooks=function(t){(function(e,t){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/books/by/").concat(e),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))})(t,G().token).then((function(t){t.error?console.log(t.error):e.setState({books:t})}))},e.loadCollections=function(t){var a=G().token;B(t,a).then((function(t){t.error?console.log(t.error):e.setState({collections:t})}))},e.loadFollowedCollections=function(t){var a=G().token;B(t,a).then((function(t){t.error?console.log(t.error):e.setState({followedCollections:t})}))},e.state={user:{following:[],followers:[]},redirectToSignin:!1,following:!1,error:"",books:[],collections:[],followedCollections:[]},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.match.params.userId;this.init(e)}},{key:"componentWillReceiveProps",value:function(e){var t=e.match.params.userId;this.init(t)}},{key:"render",value:function(){var e=this.state,t=e.redirectToSignin,a=e.user,n=e.books,r=e.collections,c=e.followedCollections;if(t)return o.a.createElement(s.a,{to:"/signin"});var i=a._id?"".concat("https://ameliacollections-api.herokuapp.com/api","/user/photo/").concat(a._id,"?").concat((new Date).getTime()):W.a;return o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"Profile"),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-4"},o.a.createElement("img",{style:{height:"200px",width:"auto"},className:"img-thumbnail",src:i,onError:function(e){return e.target.src="".concat(W.a)},alt:a.name})),o.a.createElement("div",{className:"col-md-8"},o.a.createElement("div",{className:"lead mt-2"},o.a.createElement("p",null,"Hello ",a.name),o.a.createElement("p",null,"Email: ",a.email),o.a.createElement("p",null,"Joined ".concat(new Date(a.created).toDateString()))),G().user&&G().user._id===a._id?o.a.createElement("div",{className:"d-inline-block"},o.a.createElement(l.c,{className:"btn btn-raised btn-info mr-5",to:"/book/create"},"Create Book"),o.a.createElement(l.c,{className:"btn btn-raised btn-info mr-5",to:"/collection/create"},"Create Collection"),o.a.createElement(l.c,{className:"btn btn-raised btn-success mr-5",to:"/user/edit/".concat(a._id)},"Edit Profile"),o.a.createElement(he,{userId:a._id})):o.a.createElement(fe,{following:this.state.following,onButtonClick:this.clickFollowButton}),o.a.createElement("div",null,G().user&&"admin"===G().user.role&&o.a.createElement("div",{class:"card mt-5"},o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",{className:"card-title"},"Admin"),o.a.createElement("p",{className:"mb-2 text-danger"},"Edit/Delete as an Admin"),o.a.createElement(l.c,{className:"btn btn-raised btn-success mr-5",to:"/user/edit/".concat(a._id)},"Edit Profile"),o.a.createElement(he,null)))))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col md-12 mt-5 mb-5"},o.a.createElement("hr",null),o.a.createElement("p",{className:"lead"},a.about),o.a.createElement("hr",null),o.a.createElement(ge,{followers:a.followers,following:a.following,books:n,collections:r,followedCollections:c}))))}}]),a}(n.Component),be=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).renderUsers=function(e){return o.a.createElement("div",{className:"row"},e.map((function(e,t){return o.a.createElement("div",{className:"card col-md-4",key:t},o.a.createElement("img",{style:{height:"200px",width:"auto"},className:"img-thumbnail",src:"".concat("https://ameliacollections-api.herokuapp.com/api","/user/photo/").concat(e._id),onError:function(e){return e.target.src="".concat(W.a)},alt:e.name}),o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",{className:"card-title"},e.name),o.a.createElement("p",{className:"card-text"},e.email),o.a.createElement(l.c,{to:"/user/".concat(e._id),className:"btn btn-raised btn-primary btn-sm"},"View Profile")))})))},e.state={users:[]},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/users"),{method:"GET"}).then((function(e){return e.json()})).catch((function(e){return console.log(e)})).then((function(t){t.error?console.log(t.error):e.setState({users:t})}))}},{key:"render",value:function(){var e=this.state.users;return o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"Users"),this.renderUsers(e))}}]),a}(n.Component),ve=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).init=function(t){var a=G().token;me(t,a).then((function(t){t.error?e.setState({redirectToProfile:!0}):e.setState({id:t._id,name:t.name,email:t.email,error:"",about:t.about})}))},e.isValid=function(){var t=e.state,a=t.name,n=t.email,o=t.password;return t.fileSize>1e6?(e.setState({error:"File size should be less than 100kb",loading:!1}),!1):0===a.length?(e.setState({error:"Name is required",loading:!1}),!1):/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(n)?!(o.length>=1&&o.length<=5)||(e.setState({error:"Password must be at least 6 characters long",loading:!1}),!1):(e.setState({error:"A valid Email is required",loading:!1}),!1)},e.handleChange=function(t){return function(a){var n;e.setState({error:""});var o="photo"===t?a.target.files[0]:a.target.value,r="photo"===t?a.target.files[0].size:0;e.userData.set(t,o),e.setState((n={},Object(j.a)(n,t,o),Object(j.a)(n,"fileSize",r),n))}},e.clickSubmit=function(t){(t.preventDefault(),e.setState({loading:!0}),e.isValid())&&function(e,t,a){return console.log("USER DATA UPDATE: ",a),fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/user/").concat(e),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)},body:a}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))}(e.props.match.params.userId,G().token,e.userData).then((function(t){t.error?e.setState({error:t.error}):"admin"===G().user.role?e.setState({redirectToProfile:!0}):function(e,t){if("undefined"!==typeof window&&localStorage.getItem("jwt")){var a=JSON.parse(localStorage.getItem("jwt"));a.user=e,localStorage.setItem("jwt",JSON.stringify(a)),t()}}(t,(function(){e.setState({redirectToProfile:!0})}))}))},e.signupForm=function(t,a,n,r){return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Profile Photo"),o.a.createElement("input",{onChange:e.handleChange("photo"),type:"file",accept:"image/*",className:"form-control"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Name"),o.a.createElement("input",{onChange:e.handleChange("name"),type:"text",className:"form-control",value:t})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Email"),o.a.createElement("input",{onChange:e.handleChange("email"),type:"email",className:"form-control",value:a})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"About"),o.a.createElement("textarea",{onChange:e.handleChange("about"),type:"text",className:"form-control",value:r})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Password"),o.a.createElement("input",{onChange:e.handleChange("password"),type:"password",className:"form-control",value:n})),o.a.createElement("button",{onClick:e.clickSubmit,className:"btn btn-raised btn-primary"},"Update"))},e.state={id:"",name:"",email:"",password:"",redirectToProfile:!1,error:"",fileSize:0,loading:!1,about:""},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.userData=new FormData;var e=this.props.match.params.userId;this.init(e)}},{key:"render",value:function(){var e=this.state,t=e.id,a=e.name,n=e.email,r=e.password,c=e.redirectToProfile,l=e.error,i=e.loading,m=e.about;if(c)return o.a.createElement(s.a,{to:"/user/".concat(t)});var u=t?"".concat("https://ameliacollections-api.herokuapp.com/api","/user/photo/").concat(t,"?").concat((new Date).getTime()):W.a;return o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"Edit Profile"),o.a.createElement("div",{className:"alert alert-danger",style:{display:l?"":"none"}},l),i?o.a.createElement("div",{className:"jumbotron text-center"},o.a.createElement("h2",null,"Loading...")):"",o.a.createElement("img",{style:{height:"200px",width:"auto"},className:"img-thumbnail",src:u,onError:function(e){return e.target.src="".concat(W.a)},alt:a}),"admin"===G().user.role&&this.signupForm(a,n,r,m),G().user._id===t&&this.signupForm(a,n,r,m))}}]),a}(n.Component),ke=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).clickFollow=function(t,a){var n=G().user._id,o=G().token;de(n,o,t._id).then((function(n){if(n.error)e.setState({error:n.error});else{var o=e.state.users;o.splice(a,1),e.setState({users:o,open:!0,followMessage:"Following ".concat(t.name)})}}))},e.renderUsers=function(t){return o.a.createElement("div",{className:"row"},t.map((function(t,a){return o.a.createElement("div",{className:"card col-md-4",key:a},o.a.createElement("img",{style:{height:"200px",width:"auto"},className:"img-thumbnail",src:"".concat("https://ameliacollections-api.herokuapp.com/api","/user/photo/").concat(t._id),onError:function(e){return e.target.src="".concat(W.a)},alt:t.name}),o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",{className:"card-title"},t.name),o.a.createElement("p",{className:"card-text"},t.email),o.a.createElement(l.c,{to:"/user/".concat(t._id),className:"btn btn-raised btn-primary btn-sm"},"View Profile"),o.a.createElement("button",{onClick:function(){return e.clickFollow(t,a)},className:"btn btn-raised btn-info float-right btn-sm"},"Follow")))})))},e.state={users:[],error:"",open:!1},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;(function(e,t){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/user/findpeople/").concat(e),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))})(G().user._id,G().token).then((function(t){t.error?console.log(t.error):e.setState({users:t})}))}},{key:"render",value:function(){var e=this.state,t=e.users,a=e.open,n=e.followMessage;return o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"Find People"),a&&o.a.createElement("div",{className:"alert alert-success"},n),this.renderUsers(t))}}]),a}(n.Component),Ne=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).isValid=function(){var t=e.state,a=t.name,n=(t.privacy,t.tags,t.about);return t.fileSize>1e5?(e.setState({error:"File size should be less than 100kb",loading:!1}),!1):0!==a.length&&0!==n.length||(e.setState({error:"All fields are required",loading:!1}),!1)},e.handleChange=function(t){return function(a){var n;e.setState({error:""});var o="photo"===t?a.target.files[0]:a.target.value,r="photo"===t?a.target.files[0].size:0;e.collectionData.set(t,o),e.setState((n={},Object(j.a)(n,t,o),Object(j.a)(n,"fileSize",r),n))}},e.clickSubmit=function(t){if(t.preventDefault(),e.setState({loading:!0}),e.isValid()){var a=G().user._id,n=G().token;x(a,n,e.collectionData).then((function(t){console.log(e.collectionData.privacy),t.error?e.setState({error:t.error}):e.setState({loading:!1,name:"",about:"",privacy:"",tags:[],redirectToProfile:!0})}))}},e.newCollectionForm=function(t,a,n,r,c){return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Collection Photo"),o.a.createElement("input",{onChange:e.handleChange("photo"),type:"file",accept:"image/*",className:"form-control"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Name"),o.a.createElement("input",{onChange:e.handleChange("name"),type:"text",className:"form-control",value:t})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"About"),o.a.createElement("textarea",{onChange:e.handleChange("about"),type:"text",className:"form-control",value:a})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Privacy"),o.a.createElement("select",{value:r,onChange:e.handleChange("privacy"),className:"form-control"},o.a.createElement("option",{value:"private"},"Private"),o.a.createElement("option",{value:"followPrivate"},"Public to followers"),o.a.createElement("option",{value:"public"},"Public"))),o.a.createElement("button",{onClick:e.clickSubmit,className:"btn btn-raised btn-primary"},"Add Collection"))},e.state={name:"",privacy:"",tags:[],photo:"",about:"",user:{},fileSize:0,loading:!1,redirectToProfile:!1},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.collectionData=new FormData,this.setState({user:G().user})}},{key:"render",value:function(){var e=this.state,t=e.name,a=e.about,n=e.tags,r=(e.photo,e.privacy,e.user),c=e.error,l=e.loading,i=e.redirectToProfile;e.setTags;return i?o.a.createElement(s.a,{to:"/user/".concat(r._id)}):o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"Add a new collection"),o.a.createElement("div",{className:"alert alert-danger",style:{display:c?"":"none"}},c),l?o.a.createElement("div",{className:"jumbotron text-center"},o.a.createElement("h2",null,"Loading...")):"",this.newCollectionForm(t,a,n))}}]),a}(n.Component),ye=(a(122),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).init=function(t){T(t).then((function(t){t.error?e.setState({redirectToProfile:!0}):e.setState({id:t.createdBy._id,name:t.name,about:t.about,privacy:t.privacy,photo:t.photo,user:t.createdBy,error:"",loading:!1})}))},e.isValid=function(){var t=e.state,a=t.name,n=(t.privacy,t.tags,t.about);return t.fileSize>1e5?(e.setState({error:"File size should be less than 100kb",loading:!1}),!1):0!==a.length&&0!==n.length||(e.setState({error:"All fields are required",loading:!1}),!1)},e.handleChange=function(t){return function(a){var n;e.setState({error:""});var o="photo"===t?a.target.files[0]:a.target.value,r="photo"===t?a.target.files[0].size:0;e.collectionData.set(t,o),console.log(e.collectionData),e.setState((n={},Object(j.a)(n,t,o),Object(j.a)(n,"fileSize",r),n))}},e.clickSubmit=function(t){t.preventDefault();var a=e.props.match.params.collectionId;if(e.setState({loading:!0}),e.isValid()){G().user._id;(function(e,t,a){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collection/update/").concat(e),{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)},body:a}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))})(a,G().token,e.collectionData).then((function(t){console.log(e.collectionData),t.error?e.setState({error:t.error}):e.setState({loading:!1,name:"",about:"",privacy:"",tags:[],redirectToProfile:!0})}))}},e.newCollectionForm=function(t,a,n,r,c){return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Collection Photo"),o.a.createElement("input",{onChange:e.handleChange("photo"),type:"file",accept:"image/*",className:"form-control"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Name"),o.a.createElement("input",{onChange:e.handleChange("name"),type:"text",className:"form-control",value:t})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"About"),o.a.createElement("textarea",{onChange:e.handleChange("about"),type:"text",className:"form-control",value:a})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Privacy"),o.a.createElement("select",{value:r,onChange:e.handleChange("privacy"),className:"form-control"},o.a.createElement("option",{value:"private"},"Private"),o.a.createElement("option",{value:"followPrivate"},"Public to followers"),o.a.createElement("option",{value:"public"},"Public"))),o.a.createElement("button",{onClick:e.clickSubmit,className:"btn btn-raised btn-primary"},"Save Collection"))},e.state={id:"",name:"",privacy:"",tags:[],photo:"",about:"",user:{},fileSize:0,loading:!1,redirectToProfile:!1},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.collectionData=new FormData,this.setState({user:G().user});var e=this.props.match.params.collectionId;this.init(e)}},{key:"render",value:function(){var e=this.state,t=e.name,a=e.about,n=e.tags,r=(e.photo,e.privacy,e.user),c=e.error,l=e.loading,i=e.redirectToProfile;e.setTags;return i?o.a.createElement(s.a,{to:"/user/".concat(r._id)}):o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"Edit a collection"),o.a.createElement("div",{className:"alert alert-danger",style:{display:c?"":"none"}},c),l?o.a.createElement("div",{className:"jumbotron text-center"},o.a.createElement("h2",null,"Loading...")):"",this.newCollectionForm(t,a,n))}}]),a}(n.Component)),Ce=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={name:"",about:"",tags:[],privacy:"",redirectToSignin:!1,books:[],follow:!1,follows:0,comments:[],collection:{},loading:!0},e.showCreate=function(){e.setState({showForm:!0})},e.checkLike=function(e){var t=G()&&G().user._id;return-1!==e.indexOf(t)},e.checkFollow=function(e){var t=G()&&G().user._id;return-1!==e.indexOf(t)},e.componentDidMount=function(){e.setState({loading:!0});var t=e.props.match.params.collectionId;T(t).then((function(t){t.error?console.log(t.error):void 0!=t.likes?e.setState({collection:t,likes:t.likes.length,like:e.checkLike(t.likes),comments:t.comments,books:t.books,loading:!1}):e.setState({redirectToHome:!0})}))},e.updateComments=function(t){e.setState({comments:t})},e.handleClose=function(){e.setState({show:!1})},e.handleCloseAlert=function(){e.setState({completed:!1})},e.handleChange=function(t){if(t.persist(),t.target.checked)console.log("CHECKED"),console.log(t.target.value),e.setState((function(a){return a.selectedCollections.push(t.target.value),console.log(e.state.selectedCollections)}));else{console.log("UNCHECKED");var a=Object(O.a)(e.state.selectedCollections),n=e.state.selectedCollections.indexOf(t.target.value);if(console.log(n),-1!==n){a=a.splice(1,n),console.log(a);e.setState((function(t){return t.selectedCollections.splice(n,1),console.log(e.state.selectedCollections)}))}}},e.likeToggle=function(){if(!G())return e.setState({redirectToSignin:!0}),!1;var t=e.state.like?A:D,a=G().user._id,n=e.state.book._id;t(a,G().token,n).then((function(t){t.error?console.log(t.error):e.setState({like:!e.state.like,likes:t.likes.length})}))},e.deleteCollection=function(){var t=e.props.match.params.collectionId,a=G().token;P(t,a).then((function(t){e.setState({redirectToHome:!0})})).catch((function(t){e.setState({error:t})}))},e.deleteConfirmed=function(){window.confirm("Are you sure you want to delete your book?")&&e.deleteCollection()},e.renderBooks=function(t){return console.log(t),o.a.createElement("div",{className:"row"},t.map((function(t,a){console.log(a);var n=t.createdBy?"/user/".concat(t.createdBy._id):"",r=t.createdBy?t.createdBy.name:" Unknown";return o.a.createElement("div",{className:"card col-md-3 mr-3 mt-3",key:a},o.a.createElement("div",{className:"card-body"},o.a.createElement("img",{src:t.photo,alt:t.title,onError:function(e){return e.target.src="".concat(C.a)},className:"img-thunbnail mb-3",style:{height:"150px",width:"auto"}}),o.a.createElement("h5",{className:"card-title"},t.title),o.a.createElement("p",{className:"card-text"},t.editorial.substring(0,100)),o.a.createElement("br",null),o.a.createElement("p",{className:"font-italic"},"Posted by"," ",o.a.createElement(l.c,{to:"".concat(n)},r," "),"on ",new Date(t.created).toDateString()),o.a.createElement(l.c,{to:"/book/".concat(t._id),className:"btn btn-raised btn-primary btn-sm"},"Read more"),o.a.createElement("div",{className:"overlay"}),o.a.createElement("div",{className:"button"},o.a.createElement(w.a,{onClick:e.deleteBookConfirmed,icon:S.f}))))})))},e.renderCollection=function(t){var a=t.createdBy?"/user/".concat(t.createdBy._id):"",n=t.createdBy?t.createdBy.name:" Unknown",r=e.state,c=r.like,s=r.likes,i=(r.show,r.collections,r.showForm,r.comments,r.loading,r.follow);return o.a.createElement("div",{className:"card-body mt-5"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-4"},o.a.createElement("img",{src:"".concat(t.photo),alt:t.namee,onError:function(e){return e.target.src="".concat(C.a)},className:"img-thunbnail",style:{height:"auto",width:"100%",objectFit:"cover"}})),o.a.createElement("div",{className:"col-8"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-10"},o.a.createElement("h2",{className:"card-text"},t.name)),G().user&&G().user._id===t.createdBy._id&&o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"col-2"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col"},o.a.createElement(l.c,{to:"/collection/edit/".concat(t._id)},o.a.createElement(w.a,{size:"2x",icon:S.g}))),o.a.createElement("div",{className:"col"},o.a.createElement(w.a,{size:"2x",className:"text-danger",onClick:e.deleteConfirmed,icon:S.n})," "))))),o.a.createElement("hr",{className:"dashed"}),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},o.a.createElement("label",null,"About:")),o.a.createElement("div",{className:"col-md-6"},o.a.createElement("p",null,t.about))),o.a.createElement("hr",{className:"dashed"}),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},o.a.createElement("label",null,"Created By:")),o.a.createElement("div",{className:"col-md-6"},o.a.createElement("p",null,o.a.createElement(l.c,{to:"".concat(a)},n," ")))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},o.a.createElement("label",null,"Created On:")),o.a.createElement("div",{className:"col-md-6"},o.a.createElement("p",null,new Date(t.created).toDateString()))),o.a.createElement("hr",{className:"dashed"}),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col"},c?o.a.createElement("p",{onClick:e.likeToggle},o.a.createElement(w.a,{className:"text-success ml-2",size:"2x",icon:S.m})," "," ",s," Like"):o.a.createElement("p",{onClick:e.likeToggle},o.a.createElement(w.a,{className:"ml-2",size:"2x",icon:S.m})," ",s," Like")),o.a.createElement("div",{className:"col"},i?o.a.createElement("p",{onClick:e.followToggle},o.a.createElement(w.a,{className:"text-success ml-2",size:"2x",icon:S.m})," "," ",s," Like"):o.a.createElement("p",{onClick:e.likeToggle},o.a.createElement(w.a,{className:"ml-2",size:"2x",icon:S.m})," ",s," Like"))))))},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.state,t=e.collection,a=e.redirectToHome,n=e.redirectToSignin,r=e.loading,c=(e.comments,e.books);return a?o.a.createElement(s.a,{to:"/"}):n?o.a.createElement(s.a,{to:"/signin"}):(console.log(c),o.a.createElement("div",{className:"container"},r?o.a.createElement("div",{className:"jumbotron text-center"},o.a.createElement("h2",null,"Loading...")):t?this.renderCollection(t):o.a.createElement("div",{className:"text-center"},o.a.createElement("h2",null,"No results")),o.a.createElement("h4",{className:"display-2 mt-5 mb-5",hidden:!c.length>0},"Books"),this.renderBooks(c)))}}]),a}(n.Component),we=a(97),Se=(a(123),a(126)),je=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).isValid=function(){var t=e.state,a=t.title,n=t.editorial,o=t.language;t.isbn;return t.fileSize>1e5?(e.setState({error:"File size should be less than 100kb",loading:!1}),!1):0!==a.length&&0!==n.length&&0!=o.length||(e.setState({error:"All fields are required",loading:!1}),!1)},e.isUnique=function(t){var a=t.replace(/[- ]|^ISBN(?:-1[03])?:?/g,"");return function(e,t){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/book/isbn/").concat(t),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))}(G().token,a).then((function(t){return console.log(t),void 0!=t[0]?(console.log(t[0]),e.setState({error:"Book already exists. ",errorURL:t[0]._id}),!1):(console.log("HHH"),!0)})),!0},e.handleChange=function(t){return function(a){var n;e.setState({error:""});var o="photo"===t?a.target.files[0]:a.target.value,r="photo"===t?a.target.files[0].size:0;e.bookData.set(t,o),console.log(e.bookData),e.setState((n={},Object(j.a)(n,t,o),Object(j.a)(n,"fileSize",r),n))}},e.checkISBN=function(e){if(/^(?=(?:\D*\d){10}(?:(?:\D*\d){3})?$)/.test(e)){var t,a,n=e.replace(/[- ]|^ISBN(?:-1[03])?:?/g,"").split(""),o=n.pop(),r=0;if(9==n.length){for(n.reverse(),a=0;a<n.length;a++)r+=(a+2)*parseInt(n[a],10);10==(t=11-r%11)?t="X":11==t&&(t="0")}else{for(a=0;a<n.length;a++)r+=(a%2*2+1)*parseInt(n[a],10);10==(t=10-r%10)&&(t="0")}return t==o||(console.log("Invalid ISBN check digit"),!1)}return console.log("OTRO ERROR"),!1},e.handleChangeISBN=function(){return function(){var t=Object(f.a)(h.a.mark((function t(a){var n,o;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=a.target.value,e.checkISBN(n)?(o=n.replace(/[- ]|^ISBN(?:-1[03])?:?/g,""),Se.resolve(n).then((function(t){console.log(t),null!=t?(e.setState({title:t.title,editorial:t.publisher,language:t.language,isbn:n,error:""}),e.bookData.set("title",t.title),e.bookData.set("editorial",t.publisher),e.bookData.set("language",t.language),e.bookData.set("isbn",o)):e.bookData.set("isbn",o),e.setState({error:""})}))):e.setState({error:"Not a valid ISBN"}),0==n.length&&e.setState({error:""});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},e.clickSubmit=function(t){(t.preventDefault(),e.setState({loading:!0}),e.isValid()&&e.isUnique(e.state.isbn))&&(console.log("hola"),function(e,t,a){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/book/new/").concat(e),{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)},body:a}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))}(G().user._id,G().token,e.bookData).then((function(t){t.error?e.setState({error:t.error}):e.setState({loading:!1,title:"",editorial:"",language:"",illustrator:"",isbn:"",error:"",redirectToNewBook:!0,book:t})}),(function(t){console.error(t);var a=t.response.data,n=a.message,o=a.errors;e.setState({error:Object(we.a)({},o),globalError:!o&&n})})))},e.newBookForm=function(t,a,n,r,c){return o.a.createElement("form",null,c?o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Book Photo"),o.a.createElement("input",{onChange:e.handleChange("photo"),type:"file",accept:"image/*",className:"form-control"})):null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"ISBN"),o.a.createElement("textarea",{onChange:e.handleChangeISBN(),type:"text",className:"form-control",value:c})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Title"),o.a.createElement("input",{onChange:e.handleChange("title"),type:"text",className:"form-control",value:t})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Editorial"),o.a.createElement("textarea",{onChange:e.handleChange("editorial"),type:"text",className:"form-control",value:a})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Language"),o.a.createElement("textarea",{onChange:e.handleChange("language"),type:"text",className:"form-control",value:n})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Illustrator"),o.a.createElement("textarea",{onChange:e.handleChange("illustrator"),type:"text",className:"form-control",value:r})),o.a.createElement("button",{onClick:e.clickSubmit,className:"btn btn-raised btn-primary"},"Add Book"))},e.state={title:"",editorial:"",language:"",illustrator:"",isbn:"",photo:"",error:"",globalError:"",user:{},fileSize:0,loading:!1,redirectToProfile:!1,redirectToNewBook:!1,errorURL:"",book:""},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.bookData=new FormData,this.setState({user:G().user})}},{key:"render",value:function(){var e=this.state,t=e.title,a=e.editorial,n=(e.isbn,e.language),r=(e.photo,e.illustrator),c=e.user,i=e.error,m=e.loading,u=e.redirectToProfile,d=e.redirectToNewBook,p=e.errorURL,h=e.book,f=p?"/book/".concat(p):"";return u?o.a.createElement(s.a,{to:"/user/".concat(c._id)}):d?o.a.createElement(s.a,{to:"/book/".concat(h._id)}):o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"Add a new book"),o.a.createElement("div",{className:"alert alert-danger",style:{display:i?"":"none"}},i,p?o.a.createElement(l.c,{to:"".concat(f)}," Check it out here!"):null),m&&!i?o.a.createElement("div",{className:"jumbotron text-center"},o.a.createElement("h2",null,"Loading...")):"",this.newBookForm(t,a,n,r))}}]),a}(n.Component),Oe=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).init=function(t){console.log(t),g(t).then((function(t){t.error?e.setState({redirectToProfile:!0}):e.setState({id:t.createdBy._id,title:t.title,editorial:t.editorial,isbn:t.isbn,photo:t.photo,language:t.language,error:"",loading:!1})}))},e.isValid=function(){var t=e.state,a=t.title,n=t.editorial;t.language,t.isbn;return t.fileSize>1e6?(e.setState({error:"File size should be less than 100kb",loading:!1}),!1):0!==a.length&&0!==n.length||(e.setState({error:"All fields are required",loading:!1}),!1)},e.handleChange=function(t){return function(a){var n;e.setState({error:""});var o="photo"===t?a.target.files[0]:a.target.value,r="photo"===t?a.target.files[0].size:0;void 0!=a.target.files&&(console.log("Hola"),e.setState({hideImg:!0})),e.bookData.set(t,o),e.setState((n={},Object(j.a)(n,t,o),Object(j.a)(n,"fileSize",r),n))}},e.clickSubmit=function(t){(t.preventDefault(),e.setState({loading:!0}),e.isValid())&&function(e,t,a){return console.log(e,t,a),fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/book/").concat(e),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(t)},body:a}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))}(e.props.match.params.bookId,G().token,e.bookData).then((function(t){t.error?e.setState({error:t.error}):e.setState(Object(j.a)({loading:!1,title:"",body:"",editorial:"",isbn:"",language:"",redirectToProfile:!0},"loading",!1))}))},e.editBookForm=function(t,a,n,r,c,l){return o.a.createElement(o.a.Fragment,null,l?null:o.a.createElement("img",{style:{height:"200px",width:"auto"},className:"img-thumbnail",src:c,onError:function(e){return e.target.src="".concat("https://cdn.pixabay.com/photo/2018/01/03/09/09/book-3057901_1280.png")},alt:t}),o.a.createElement("hr",{className:"dashed"}),o.a.createElement("form",{className:"mt-3"},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Book Photo"),o.a.createElement("input",{onChange:e.handleChange("photo"),type:"file",accept:"image/*",className:"form-control"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Title"),o.a.createElement("input",{onChange:e.handleChange("title"),type:"text",className:"form-control",value:t})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Editorial"),o.a.createElement("input",{onChange:e.handleChange("editorial"),type:"text",className:"form-control",value:n})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"ISBN"),o.a.createElement("textarea",{onChange:e.handleChange("isbn"),type:"text",className:"form-control",readOnly:!0,value:a})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{className:"text-muted"},"Language"),o.a.createElement("textarea",{onChange:e.handleChange("language"),type:"text",className:"form-control",value:r})),o.a.createElement("button",{onClick:e.clickSubmit,className:"btn btn-raised btn-primary"},"Update Book")))},e.state={id:"",title:"",editorial:"",language:"",isbn:"",photo:"",redirectToProfile:!1,error:"",fileSize:0,loading:!1,hideImg:!1},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.setState({loading:!0}),this.bookData=new FormData;var e=this.props.match.params.bookId;this.init(e)}},{key:"render",value:function(){var e=this.state,t=e.id,a=e.title,n=e.editorial,r=e.language,c=e.photo,l=e.isbn,i=e.redirectToProfile,m=e.error,u=e.loading,d=e.hideImg;return i?o.a.createElement(s.a,{to:"/user/".concat(G().user._id)}):o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},a),o.a.createElement("div",{className:"alert alert-danger",style:{display:m?"":"none"}},m),u?o.a.createElement("div",{className:"jumbotron text-center"},o.a.createElement("h2",null,"Loading...")):"","admin"===G().user.role&&this.editBookForm(a,l,n,r,c,d),G().user._id===t&&this.editBookForm(a,l,n,r,c,d))}}]),a}(n.Component),xe=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={text:"",error:""},e.handleChange=function(t){e.setState({error:""}),e.setState({text:t.target.value})},e.isValid=function(){var t=e.state.text;return!(!t.length>0||t.length>150)||(e.setState({error:"Comment should not be empty and less than 150 characters long"}),!1)},e.addComment=function(t){if(t.preventDefault(),!G())return e.setState({error:"Please signin to leave a comment"}),!1;if(e.isValid()){var a=G().user._id,n=G().token,o=e.props.bookId;k(a,n,o,{text:e.state.text}).then((function(t){t.error?console.log(t.error):(e.setState({text:""}),e.props.updateComments(t.comments))}))}},e.deleteComment=function(t){var a=G().user._id,n=G().token,o=e.props.bookId;N(a,n,o,t).then((function(t){t.error?console.log(t.error):e.props.updateComments(t.comments)}))},e.deleteConfirmed=function(t){window.confirm("Are you sure you want to delete your comment?")&&e.deleteComment(t)},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this,t=this.props.comments,a=this.state.error;return o.a.createElement("div",null,o.a.createElement("h2",{className:"mt-5 mb-5"},"Leave a comment"),o.a.createElement("form",{onSubmit:this.addComment},o.a.createElement("div",{className:"form-group"},o.a.createElement("input",{type:"text",onChange:this.handleChange,value:this.state.text,className:"form-control",placeholder:"Leave a comment..."}),o.a.createElement("button",{className:"btn btn-raised btn-success mt-2"},"Post"))),o.a.createElement("div",{className:"alert alert-danger",style:{display:a?"":"none"}},a),o.a.createElement("div",{className:"col-md-12"},o.a.createElement("h3",{className:"text-primary"},t.length," Comments"),o.a.createElement("hr",null),t.map((function(t,a){return o.a.createElement("div",{key:a},o.a.createElement("div",null,o.a.createElement(l.c,{to:"/user/".concat(t.createdBy._id)},o.a.createElement("img",{style:{borderRadius:"50%",border:"1px solid black"},className:"float-left mr-2",height:"30px",width:"30px",onError:function(e){return e.target.src="".concat(W.a)},src:"".concat("https://ameliacollections-api.herokuapp.com/api","/user/photo/").concat(t.createdBy._id),alt:t.createdBy.name})),o.a.createElement("div",null,o.a.createElement("p",{className:"lead"},t.text),o.a.createElement("p",{className:"font-italic mark"},"Posted by"," ",o.a.createElement(l.c,{to:"/user/".concat(t.createdBy._id)},t.createdBy.name," "),"on"," ",new Date(t.created).toDateString(),o.a.createElement("span",null,G().user&&G().user._id===t.createdBy._id&&o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{onClick:function(){return e.deleteConfirmed(t)},className:"text-danger float-right mr-1"},"Remove")))))))}))))}}]),a}(n.Component),Te=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={book:"",redirectToHome:!1,redirectToSignin:!1,like:!1,likes:0,show:!1,collections:[],selectedCollections:[],existingCollections:[],comments:[],showForm:!1,loading:!1,loadingModal:!1,error:"",completed:!1},e.showCreate=function(){e.setState({showForm:!0})},e.checkLike=function(e){var t=G()&&G().user._id;return-1!==e.indexOf(t)},e.componentDidMount=function(){e.setState({loading:!0});var t=e.props.match.params.bookId;g(t).then((function(t){t.error?console.log(t.error):(console.log(t),void 0!=t.likes?e.setState({book:t,likes:t.likes.length,like:e.checkLike(t.likes),comments:t.comments,loading:!1}):e.setState({redirectToHome:!0}))}))},e.updateComments=function(t){e.setState({comments:t})},e.handleClose=function(){e.setState({show:!1})},e.handleCloseAlert=function(){e.setState({completed:!1})},e.saveChanges=function(){console.log(),e.handleClose()},e.handleOpen=function(){e.setState({show:!0}),console.log("ASDFASS")},e.handleChange=function(t){if(t.persist(),t.target.checked)console.log("CHECKED"),console.log(t.target.value),e.setState((function(a){return a.selectedCollections.push(t.target.value),console.log(e.state.selectedCollections)}));else{console.log("UNCHECKED");var a=Object(O.a)(e.state.selectedCollections),n=e.state.selectedCollections.indexOf(t.target.value);if(console.log(n),-1!==n){a=a.splice(1,n),console.log(a);e.setState((function(t){return t.selectedCollections.splice(n,1),console.log(e.state.selectedCollections)}))}}},e.showModal=function(t){e.setState({show:!e.state.show})},e.submitForm=function(t){t.preventDefault();var a=t.target,n=new FormData(a);e.collectionData=new FormData;var o=e.state.existingCollections.filter((function(t){return!e.state.selectedCollections.includes(t)})),r=e.state.selectedCollections.filter((function(t){return!e.state.existingCollections.includes(t)}));console.log(o),console.log(r),r.forEach((function(t){F(G().user._id,G().token,t,e.state.book._id).then((function(e){e.error?console.log(e.error):console.log(e)}))})),o.forEach((function(t){z(G().user._id,G().token,t,e.state.book._id).then((function(e){e.error?console.log(e.error):console.log(e)}))})),void 0!=n.get("collectionName")?(e.collectionData.set("name",n.get("collectionName")),e.collectionData.set("privacy",n.get("collectionPrivacy")),x(G().user._id,G().token,e.collectionData).then((function(t){t.error?console.log(t.error):F(G().user._id,G().token,t._id,e.state.book._id).then((function(t){t.error?console.log(t.error):(console.log(t),e.setState({completed:!0}),e.handleClose())}))}))):(e.setState({completed:!0}),e.handleClose())},e.likeToggle=function(){if(!G())return e.setState({redirectToSignin:!0}),!1;var t=e.state.like?v:b,a=G().user._id,n=e.state.book._id;t(a,G().token,n).then((function(t){t.error?console.log(t.error):e.setState({like:!e.state.like,likes:t.likes.length})}))},e.deleteBook=function(){var t=e.props.match.params.bookId,a=G().token;E(t,a).then((function(t){e.setState({redirectToHome:!0})})).catch((function(t){e.setState({error:t})}))},e.deleteConfirmed=function(){window.confirm("Are you sure you want to delete your book?")&&e.deleteBook()},e.renderBook=function(t){var a=t.createdBy?"/user/".concat(t.createdBy._id):"",n=t.createdBy?t.createdBy.name:" Unknown",r=e.state,c=r.like,s=r.likes,i=r.show,m=(r.collections,r.showForm,r.comments);r.loading,r.loadingModal,r.completed,r.selectedCollections;return o.a.createElement("div",{className:"card-body mt-5"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col"},o.a.createElement("img",{src:"".concat(t.photo),alt:t.title,onError:function(e){return e.target.src="".concat(C.a)},className:"img-thunbnail",style:{height:"auto",width:"30%",objectFit:"cover"}})),o.a.createElement("div",{className:"col"},o.a.createElement("h2",{className:"card-text"},t.title),o.a.createElement("hr",{className:"dashed"}),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},o.a.createElement("label",null,"Editorial:")),o.a.createElement("div",{className:"col-md-6"},o.a.createElement("p",null,t.editorial))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},o.a.createElement("label",null,"ISBN:")),o.a.createElement("div",{className:"col-md-6"},o.a.createElement("p",null,t.isbn))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},o.a.createElement("label",null,"Language:")),o.a.createElement("div",{className:"col-md-6"},o.a.createElement("p",null,t.language))),o.a.createElement("hr",{className:"dashed"}),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},o.a.createElement("label",null,"Added By:")),o.a.createElement("div",{className:"col-md-6"},o.a.createElement("p",null,o.a.createElement(l.c,{to:"".concat(a)},n," ")))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},o.a.createElement("label",null,"Added On:")),o.a.createElement("div",{className:"col-md-6"},o.a.createElement("p",null,new Date(t.created).toDateString()))),o.a.createElement("hr",{className:"dashed"}),G().user&&o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col"},c?o.a.createElement("p",{onClick:e.likeToggle},o.a.createElement(w.a,{className:"text-success",size:"2x",icon:S.m})," "," ",s," Like"):o.a.createElement("p",{onClick:e.likeToggle},o.a.createElement(w.a,{size:"2x",icon:S.m})," ",s," Like")),o.a.createElement("div",{className:"col"},o.a.createElement(K,{show:i,onClose:e.showModal,book:t}),o.a.createElement("p",{onClick:e.handleOpen,variant:"primary"},o.a.createElement(w.a,{size:"2x",icon:S.i})," ","Add to collection"))))),o.a.createElement("br",null),o.a.createElement("div",{className:"d-inline-block"},G().user&&G().user._id===t.createdBy._id&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.c,{to:"/book/edit/".concat(t._id),className:"btn btn-raised btn-warning btn-sm mr-5"},"Update Book"),o.a.createElement("button",{onClick:e.deleteConfirmed,className:"btn btn-raised btn-danger"},"Delete Book")),o.a.createElement("div",null,G().user&&"admin"===G().user.role&&o.a.createElement("div",{className:"card mt-5"},o.a.createElement("div",{className:"card-body"},o.a.createElement("h5",{className:"card-title"},"Admin"),o.a.createElement("p",{className:"mb-2 text-danger"},"Edit/Delete as an Admin"),o.a.createElement(l.c,{to:"/book/edit/".concat(t._id),className:"btn btn-raised btn-warning btn-sm mr-5"},"Update Book"),o.a.createElement("button",{onClick:e.deleteConfirmed,className:"btn btn-raised btn-danger"},"Delete Book"))))),o.a.createElement(xe,{bookId:t._id,comments:m.reverse(),updateComments:e.updateComments}))},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this.state,t=e.book,a=e.redirectToHome,n=e.redirectToSignin,r=e.loading;return a?o.a.createElement(s.a,{to:"/"}):n?o.a.createElement(s.a,{to:"/signin"}):o.a.createElement("div",{className:"container"},r?o.a.createElement("div",{className:"jumbotron text-center"},o.a.createElement("h2",null,"Loading...")):t?this.renderBook(t):o.a.createElement("div",{className:"text-center"},o.a.createElement("h2",null,"No results")))}}]),a}(n.Component),Be=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).loadBooks=function(t){e.setState({loading:!0}),(console.log("H"),fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/books/all"),{method:"GET"}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))).then((function(t){t?e.setState({books:t,loading:!1}):e.setState({books:[]})}))},e.loadMore=function(t){e.setState({page:e.state.page+t}),e.loadBooks(e.state.page+t)},e.loadLess=function(t){e.setState({page:e.state.page-t}),e.loadBooks(e.state.page-t)},e.renderBooks=function(e){return o.a.createElement("div",{className:"row"},e.map((function(e,t){var a=e.createdBy?"/user/".concat(e.createdBy._id):"",n=e.createdBy?e.createdBy.name:" Unknown";return o.a.createElement("div",{className:"card col-md-3 mr-3 mt-3",key:t},o.a.createElement("div",{className:"card-body"},o.a.createElement("img",{src:e.photo,alt:e.title,onError:function(e){return e.target.src="".concat(C.a)},className:"img-thunbnail mb-3",style:{height:"150px",width:"auto"}}),o.a.createElement("h5",{className:"card-title"},e.title),o.a.createElement("p",{className:"card-text"},e.editorial.substring(0,100)),o.a.createElement("br",null),o.a.createElement("p",{className:"font-italic"},"Posted by"," ",o.a.createElement(l.c,{to:"".concat(a)},n," "),"on ",new Date(e.created).toDateString()),o.a.createElement(l.c,{to:"/book/".concat(e._id),className:"btn btn-raised btn-primary btn-sm"},"Read more")))})))},e.state={books:[],loading:!1},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.loadBooks(this.state.page)}},{key:"render",value:function(){var e=this.state,t=e.books,a=(e.page,e.loading);return o.a.createElement("div",{className:"container"},a?o.a.createElement("div",{className:"jumbotron text-center"},o.a.createElement("h2",null,"Loading...")):o.a.createElement(o.a.Fragment,null,o.a.createElement("h2",{className:"mt-5 mb-5"},t.length?"Recent Books":"No books!"),o.a.createElement("div",null,this.renderBooks(t))))}}]),a}(n.Component),Pe=a(100),De=function(e){var t=e.component,a=Object(Pe.a)(e,["component"]);return o.a.createElement(s.b,Object.assign({},a,{render:function(e){return G()?o.a.createElement(t,e):o.a.createElement(s.a,{to:{pathname:"/signin",state:{from:e.location}}})}}))},Ae=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={email:"",message:"",error:""},e.forgotPassword=function(t){t.preventDefault(),e.setState({message:"",error:""}),V(e.state.email).then((function(t){t.error?(console.log(t.error),e.setState({error:t.error})):(console.log(t.message),e.setState({message:t.message}))}))},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"Ask for Password Reset"),this.state.message&&o.a.createElement("h4",{className:"bg-success"},this.state.message),this.state.error&&o.a.createElement("h4",{className:"bg-warning"},this.state.error),o.a.createElement("form",null,o.a.createElement("div",{className:"form-group mt-5"},o.a.createElement("input",{type:"email",className:"form-control",placeholder:"Your email address",value:this.state.email,name:"email",onChange:function(t){return e.setState({email:t.target.value,message:"",error:""})},autoFocus:!0})),o.a.createElement("button",{onClick:this.forgotPassword,className:"btn btn-raised btn-primary"},"Send Password Rest Link")))}}]),a}(n.Component),_e=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).resetPassword=function(e){var t;e.preventDefault(),n.setState({message:"",error:""}),(t={newPassword:n.state.newPassword,resetPasswordLink:n.props.match.params.resetPasswordToken},fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/reset-password/"),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return console.log("forgot password response: ",e),e.json()})).catch((function(e){return console.log(e)}))).then((function(e){e.error?(console.log(e.error),n.setState({error:e.error,newPassword:""})):(console.log(e.message),n.setState({message:e.message,newPassword:""}))}))},n.state={newPassword:"",message:"",error:""},n}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},"Reset your Password"),this.state.message&&o.a.createElement("h4",{className:"bg-success"},this.state.message),this.state.error&&o.a.createElement("h4",{className:"bg-warning"},this.state.error),o.a.createElement("form",{style:{display:this.state.message.length?"none":""}},o.a.createElement("div",{className:"form-group mt-5"},o.a.createElement("input",{type:"password",className:"form-control",placeholder:"Your new password",value:this.state.newPassword,name:"newPassword",onChange:function(t){return e.setState({newPassword:t.target.value,message:"",error:""})},autoFocus:!0})),o.a.createElement("button",{onClick:this.resetPassword,className:"btn btn-raised btn-primary"},"Reset Password")))}}]),a}(n.Component),Ie=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){var e=this.props,t=e.users,a=e.books,n=e.collections;return console.log(t.length),o.a.createElement("div",null,0==a.length&&0==t.length&&0==n.length?o.a.createElement("div",{className:"text-center"},o.a.createElement("h2",null,"No results")):o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-4"},o.a.createElement("h3",{className:"text-primary"},t.length," Users"),o.a.createElement("hr",null),t.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement("div",null,o.a.createElement(l.c,{to:"/user/".concat(e._id)},o.a.createElement("img",{style:{borderRadius:"50%",border:"1px solid black"},className:"float-left mr-2",height:"30px",width:"30px",onError:function(e){return e.target.src="".concat(W.a)},src:"".concat("https://ameliacollections-api.herokuapp.com/api","/user/photo/").concat(e._id),alt:e.name}),o.a.createElement("div",null,o.a.createElement("p",{className:"lead"},e.name)))))}))),o.a.createElement("div",{className:"col-md-4"},o.a.createElement("h3",{className:"text-primary"},n.length," Collections"),o.a.createElement("hr",null),n.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement("div",null,o.a.createElement(l.c,{to:"/collection/".concat(e._id)},o.a.createElement("div",null,o.a.createElement("p",{className:"lead"},e.name)))))}))),o.a.createElement("div",{className:"col-md-4"},o.a.createElement("h3",{className:"text-primary"},a.length," Books"),o.a.createElement("hr",null),a.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement("div",null,o.a.createElement(l.c,{to:"/book/".concat(e._id)},o.a.createElement("div",null,o.a.createElement("p",{className:"lead"},e.title)))))})))))}}]),a}(n.Component),Fe=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).init=function(t){console.log(t),e.loadUsers(t),e.loadBooks(t),e.loadCollections(t)},e.isValid=function(){return 0!==e.state.search.length||(e.setState({error:"All fields are required",loading:!1}),!1)},e.loadBooks=function(t){G().token;(function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/books/").concat(e),{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))})(t).then((function(t){t.error?console.log(t.error):e.setState({books:t})}))},e.loadCollections=function(t){G().token;(function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/collections/").concat(e),{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))})(t).then((function(t){t.error?console.log(t.error):e.setState({collections:t})}))},e.loadUsers=function(t){G().token;(function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/users/").concat(e),{method:"GET",headers:{Accept:"application/json"}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))})(t).then((function(t){t.error?console.log(t.error):e.setState({users:t,loading:!1})}))},e.handleChange=function(t){return function(a){e.setState({error:""});var n=a.target.value;e.searchData.set(t,n),e.setState(Object(j.a)({},t,n))}},e.clickSearch=function(t){if(t.preventDefault(),e.setState({loading:!0}),e.isValid()){G().user._id,G().token;e.init(e.state.search)}},e.state=Object(j.a)({redirectToSignin:!1,error:"",search:"",loading:"",books:[],collections:[],users:[]},"loading",!1),e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.searchData=new FormData,void 0!=this.props.location.state&&this.setState({search:this.props.location.state.search,loading:!0},this.init(this.props.location.state.search))}},{key:"render",value:function(){var e=this.state,t=e.redirectToSignin,a=e.users,n=e.books,r=e.collections,c=e.search,l=e.loading;return t?o.a.createElement(s.a,{to:"/signin"}):o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:"row justify-content-center"},o.a.createElement("div",{className:"col-12 col-md-10 col-lg-8 mt-5 mb-5"},o.a.createElement("form",{className:"card card-sm"},o.a.createElement("div",{className:"card-body row no-gutters align-items-center"},o.a.createElement("div",{className:"col"},o.a.createElement("input",{className:"form-control form-control-lg form-control-borderless",value:c,onChange:this.handleChange("search"),type:"search",placeholder:"     Search for books, collections or users"})),o.a.createElement("div",{className:"col-auto"},o.a.createElement("button",{className:"btn btn-lg ml-2",onClick:this.clickSearch},o.a.createElement(w.a,{icon:S.j,size:"2x"}))))))),this.state.search?o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-12"},l?o.a.createElement("div",{className:"jumbotron text-center"},o.a.createElement("h2",null,"Loading...")):o.a.createElement(Ie,{users:a,books:n,collections:r}))):o.a.createElement("div",null))}}]),a}(n.Component),ze=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(i.a)(this,a),(e=t.call(this)).loadPosts=function(t){(function(e){return fetch("".concat("https://ameliacollections-api.herokuapp.com/api","/posts/?page=").concat(e),{method:"GET"}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))})(t).then((function(t){t.error?console.log(t.error):e.setState({posts:t})}))},e.loadMore=function(t){e.setState({page:e.state.page+t}),e.loadPosts(e.state.page+t)},e.loadLess=function(t){e.setState({page:e.state.page-t}),e.loadPosts(e.state.page-t)},e.renderPosts=function(e){return o.a.createElement("div",{className:"row"},e.map((function(e,t){var a=e.postedBy?"/user/".concat(e.postedBy._id):"",n=e.postedBy?e.postedBy.name:" Unknown";return o.a.createElement("div",{className:"card col-md-4",key:t},o.a.createElement("div",{className:"card-body"},o.a.createElement("img",{src:"".concat("https://ameliacollections-api.herokuapp.com/api","/post/photo/").concat(e._id),alt:e.title,onError:function(e){return e.target.src="".concat(C.a)},className:"img-thunbnail mb-3",style:{height:"200px",width:"100%"}}),o.a.createElement("h5",{className:"card-title"},e.title),o.a.createElement("p",{className:"card-text"},e.body.substring(0,100)),o.a.createElement("br",null),o.a.createElement("p",{className:"font-italic mark"},"Posted by"," ",o.a.createElement(l.c,{to:"".concat(a)},n," "),"on ",new Date(e.created).toDateString()),o.a.createElement(l.c,{to:"/post/".concat(e._id),className:"btn btn-raised btn-primary btn-sm"},"Read more")))})))},e.state={posts:[],page:1},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.loadPosts(this.state.page)}},{key:"render",value:function(){var e=this,t=this.state,a=t.posts,n=t.page;return o.a.createElement("div",{className:"container"},o.a.createElement("h2",{className:"mt-5 mb-5"},a.length?"Recent Posts":"No more posts!"),this.renderPosts(a),n>1?o.a.createElement("button",{className:"btn btn-raised btn-warning mr-5 mt-5 mb-5",onClick:function(){return e.loadLess(1)}},"Previous (",this.state.page-1,")"):"",a.length?o.a.createElement("button",{className:"btn btn-raised btn-success mt-5 mb-5",onClick:function(){return e.loadMore(1)}},"Next (",n+1,")"):"")}}]),a}(n.Component),Ue=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(e=t.call.apply(t,[this].concat(o))).state={redirectToHome:!1},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){"admin"!==G().user.role&&this.setState({redirectToHome:!0})}},{key:"render",value:function(){return this.state.redirectToHome?o.a.createElement(s.a,{to:"/"}):o.a.createElement("div",null,o.a.createElement("div",{className:"jumbotron"},o.a.createElement("h2",null,"Admin Dashboard"),o.a.createElement("p",{className:"lead"},"Welcome to React Frontend")),o.a.createElement("div",{className:"container-fluid"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-6"},o.a.createElement("h2",null,"Posts"),o.a.createElement("hr",null),o.a.createElement(ze,null)),o.a.createElement("div",{className:"col-md-6"},o.a.createElement("h2",null,"Users"),o.a.createElement("hr",null),o.a.createElement(be,null)))))}}]),a}(n.Component),Le=function(){return o.a.createElement("div",null,o.a.createElement(oe,null),o.a.createElement(s.d,null,o.a.createElement(s.b,{exact:!0,path:"/",component:Q}),o.a.createElement(De,{exact:!0,path:"/admin",component:Ue}),o.a.createElement(s.b,{exact:!0,path:"/forgot-password",component:Ae}),o.a.createElement(s.b,{exact:!0,path:"/reset-password/:resetPasswordToken",component:_e}),o.a.createElement(De,{exact:!0,path:"/collection/create",component:Ne}),o.a.createElement(s.b,{exact:!0,path:"/collection/:collectionId",component:Ce}),o.a.createElement(De,{exact:!0,path:"/collection/edit/:collectionId",component:ye}),o.a.createElement(De,{exact:!0,path:"/book/create",component:je}),o.a.createElement(s.b,{exact:!0,path:"/books",component:Be}),o.a.createElement(s.b,{exact:!0,path:"/book/:bookId",component:Te}),o.a.createElement(De,{exact:!0,path:"/book/edit/:bookId",component:Oe}),o.a.createElement(s.b,{exact:!0,path:"/users",component:be}),o.a.createElement(s.b,{exact:!0,path:"/signup",component:se}),o.a.createElement(s.b,{exact:!0,path:"/signin",component:ie}),o.a.createElement(De,{exact:!0,path:"/user/edit/:userId",component:ve}),o.a.createElement(De,{exact:!0,path:"/findpeople",component:ke}),o.a.createElement(De,{exact:!0,path:"/user/:userId",component:Ee}),o.a.createElement(De,{exact:!0,path:"/finder",component:Fe})))},Re=function(){return o.a.createElement(l.b,null,o.a.createElement(Le,null))};c.a.render(o.a.createElement(l.a,{basename:"https://asalria.github.io/collections-web"},o.a.createElement(Re,null)),document.getElementById("root"))},16:function(e,t,a){e.exports=a.p+"static/media/avatar.b23d5960.jpg"},22:function(e,t,a){e.exports=a.p+"static/media/mountains.586806cd.jpg"}},[[102,1,2]]]);
//# sourceMappingURL=main.64b06377.chunk.js.map